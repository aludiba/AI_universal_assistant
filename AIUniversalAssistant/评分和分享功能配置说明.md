# 评分和分享功能配置说明

## ✅ 已完成的功能

### 1. 前往评分功能
在设置页面添加了"前往评分"选项，点击后：
- ✅ 首先弹出系统原生评分弹窗（iOS 10.3+）
- ✅ 可选：引导用户前往App Store评分页面

### 2. 分享APP功能
在设置页面添加了"分享APP"选项，点击后：
- ✅ 弹出系统分享面板
- ✅ 可分享到微信、朋友圈、短信、邮件等
- ✅ 包含应用名称、描述和下载链接
- ✅ 支持iPad的popover展示

## 📝 新增的设置项

设置页面新增两个选项：
```
会员特权
创作记录
创作字数包
⭐ 前往评分     （新增）
🔗 分享APP      （新增）
联系我们
关于我们
```

## 🔧 需要配置的内容

### ⚠️ App Store ID（重要！）

上架到App Store后，需要替换以下位置的App Store ID：

**位置**：`AIUniversalAssistant/Settings/Controller/AIUASettingsViewController.m`

#### 1. 评分功能中的App Store ID
```objective-c
// 第232行
- (void)openAppStoreRatingPage {
    NSString *appID = @"YOUR_APP_STORE_ID"; // ⚠️ 替换为实际的App Store ID
    // ...
}
```

#### 2. 分享功能中的App Store链接
```objective-c
// 第264行
- (void)shareApp {
    // ...
    NSString *appStoreURL = @"https://apps.apple.com/app/YOUR_APP_STORE_ID"; // ⚠️ 替换为实际链接
    // ...
}
```

### 📱 如何获取App Store ID

#### 步骤1: 上架应用到App Store Connect
1. 登录 https://appstoreconnect.apple.com/
2. 创建新的App
3. 填写应用信息并提交审核

#### 步骤2: 获取App Store ID
- 在App Store Connect中，进入你的应用详情页
- URL中会包含应用ID，格式如：`https://appstoreconnect.apple.com/apps/1234567890/appstore`
- 其中 `1234567890` 就是你的App Store ID

#### 步骤3: 获取App Store链接
上架后，在App Store搜索你的应用，获取分享链接，格式如：
```
https://apps.apple.com/cn/app/your-app-name/id1234567890
```

### 🔄 替换示例

假设你的App Store ID是 `1234567890`：

```objective-c
// 评分功能
NSString *appID = @"1234567890";

// 分享功能
NSString *appStoreURL = @"https://apps.apple.com/cn/app/ai-writing-cat/id1234567890";
```

## 🎯 功能使用说明

### 前往评分功能

#### 方式一：系统原生评分弹窗（推荐）
- ✅ 用户无需离开应用即可评分
- ✅ 简洁优雅的用户体验
- ⚠️ 系统限制：每年最多弹出3次
- 📱 需要iOS 10.3+

#### 方式二：跳转到App Store
- ✅ 用户可以写详细评论
- ✅ 无次数限制
- ⚠️ 需要离开应用
- ⚠️ 需要配置App Store ID

**当前实现**：优先使用方式一，如果系统不支持则使用方式二

### 分享APP功能

#### 分享内容包括：
```
AI写作喵

一款强大的AI写作助手，帮你轻松完成各种写作任务！

https://apps.apple.com/app/YOUR_APP_STORE_ID
```

#### 支持的分享渠道：
- ✅ 微信
- ✅ 朋友圈
- ✅ 短信
- ✅ 邮件
- ✅ 备忘录
- ✅ 其他第三方应用

#### 已排除的分享选项：
- ❌ 分配给联系人
- ❌ 打印
- ❌ 在图书中打开
- ❌ 标记PDF

## 🧪 测试功能

### 在上架前测试

即使没有App Store ID，也可以测试功能：

#### 测试评分功能
```objective-c
// 直接调用系统评分弹窗
[SKStoreReviewController requestReview];
```
- 会弹出评分界面（但没有实际App Store连接）
- 可以测试UI和交互流程

#### 测试分享功能
```objective-c
// 使用临时链接测试
NSString *appStoreURL = @"https://www.apple.com";
```
- 可以测试完整的分享流程
- 上架后替换为真实链接即可

## 📊 功能流程图

### 评分功能流程
```
用户点击"前往评分"
    ↓
检查iOS版本
    ↓
iOS 10.3+ → 弹出系统评分窗口 → 用户评分（可选）
    ↓
iOS <10.3 → 打开App Store评分页面
```

### 分享功能流程
```
用户点击"分享APP"
    ↓
准备分享内容（文案 + 链接 + 图标）
    ↓
显示系统分享面板
    ↓
用户选择分享渠道 → 完成分享
```

## 💡 优化建议

### 1. 评分时机优化
建议在以下时机引导用户评分：
- ✅ 用户完成第3次创作后
- ✅ 用户使用应用超过7天
- ✅ 用户成为VIP会员后
- ❌ 避免在应用刚启动时弹出

可以在代码中添加逻辑判断：
```objective-c
- (BOOL)shouldShowRatingPrompt {
    NSInteger useCount = [[NSUserDefaults standardUserDefaults] integerForKey:@"app_use_count"];
    NSDate *lastPromptDate = [[NSUserDefaults standardUserDefaults] objectForKey:@"last_rating_prompt_date"];
    
    // 使用次数超过3次，且距离上次提示超过30天
    if (useCount >= 3 && (!lastPromptDate || [lastPromptDate timeIntervalSinceNow] < -30*24*60*60)) {
        return YES;
    }
    return NO;
}
```

### 2. 分享奖励机制
可以添加分享激励：
```objective-c
- (void)shareApp {
    // ... 分享代码 ...
    
    activityVC.completionWithItemsHandler = ^(UIActivityType activityType, BOOL completed, NSArray *returnedItems, NSError *activityError) {
        if (completed) {
            // 分享成功，给予奖励
            [self giveShareReward]; // 例如：赠送创作字数
        }
    };
}
```

### 3. 分享文案优化
可以根据用户使用情况定制分享文案：
```objective-c
NSString *shareText;
if (userIsVIP) {
    shareText = @"我正在使用AI写作喵VIP会员，写作效率提升10倍！推荐给你～";
} else {
    shareText = @"发现一款超好用的AI写作助手，各种文案都能搞定！";
}
```

## 🔒 隐私说明

### 系统评分弹窗（SKStoreReviewController）
- ✅ 完全由系统控制
- ✅ 不收集用户信息
- ✅ 不需要额外权限
- ✅ 符合Apple隐私政策

### 系统分享面板（UIActivityViewController）
- ✅ 由系统提供
- ✅ 用户完全控制
- ✅ 不访问用户数据
- ✅ 符合隐私规范

## ✅ 功能清单

- [x] 添加"前往评分"设置项
- [x] 实现系统评分弹窗
- [x] 实现App Store跳转（待配置App Store ID）
- [x] 添加"分享APP"设置项
- [x] 实现系统分享面板
- [x] 准备分享内容（文案+链接）
- [x] iPad适配（popover）
- [x] 分享完成回调
- [x] 本地化字符串
- [x] 添加星标和分享图标
- [x] 代码注释和文档

## 📞 需要帮助？

如果在配置过程中遇到问题：
1. 检查App Store ID是否正确
2. 确认应用已成功上架
3. 测试分享链接是否可以打开
4. 查看Xcode控制台日志

---

**更新时间**：2025年11月9日  
**功能状态**：✅ 已完成，待配置App Store ID

