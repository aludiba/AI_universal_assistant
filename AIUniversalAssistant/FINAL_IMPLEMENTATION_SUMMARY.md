# å­—æ•°åŒ…ä¸VIPæƒé™ç³»ç»Ÿ - æœ€ç»ˆå®ç°æ€»ç»“

## ğŸ‰ å®ŒæˆçŠ¶æ€

**æ‰€æœ‰5å¤§éœ€æ±‚å·²å®Œæ•´å®ç°ï¼** âœ…

---

## âœ… éœ€æ±‚1ï¼šæ›´æ–°è´­ä¹°é¡»çŸ¥æ–‡æ¡ˆ

### æ–°æ–‡æ¡ˆï¼ˆ4æ¡ï¼‰

| ç¼–å· | å†…å®¹ | å˜åŒ–ç‚¹ |
|------|------|--------|
| 1 | å­—æ•°åŒ…è´­ä¹°å90å¤©å†…æœ‰æ•ˆï¼Œé€¾æœŸæœªä½¿ç”¨å°†è‡ªåŠ¨å¤±æ•ˆ | æ›´è‡ªç„¶ï¼Œå¼ºè°ƒå¤±æ•ˆ |
| 2 | ä½¿ç”¨æ—¶å°†ä¼˜å…ˆæ¶ˆè€—ä¼šå‘˜èµ é€å­—æ•°ï¼Œå…¶æ¬¡æ¶ˆè€—è´­ä¹°å­—æ•°åŒ… | æ›´æ¸…æ™°çš„ä¼˜å…ˆçº§ |
| 3 | è®¢é˜…ä»»æ„ä¼šå‘˜å¥—é¤å¯è·èµ 50ä¸‡å­—ï¼Œæœ‰æ•ˆæœŸä¸ä¼šå‘˜æ—¶é•¿ä¸€è‡´ | âœ¨ æ–°å¢ |
| 4 | å­—æ•°ç»Ÿè®¡è§„åˆ™ï¼š1ä¸ªä¸­æ–‡å­—ç¬¦ã€è‹±æ–‡å­—æ¯ã€æ•°å­—ã€æ ‡ç‚¹æˆ–ç©ºæ ¼å‡è®¡ä¸º1å­— | æ›´è¯¦ç»† |

### æœ¬åœ°åŒ–æ”¯æŒ

âœ… ä¸­æ–‡ï¼š`word_pack_note_1` ~ `word_pack_note_4`  
âœ… è‹±æ–‡ï¼šå®Œæ•´å¯¹åº”ç¿»è¯‘

---

## âœ… éœ€æ±‚2ï¼šä¼šå‘˜èµ é€50ä¸‡å­—æç¤º

### UIå®ç°

**æ˜¾ç¤ºä½ç½®**: å­—æ•°ä¿¡æ¯å¡ç‰‡ä¸‹æ–¹

**æ ·å¼è®¾è®¡**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¼šå‘˜èµ é€: 500,000å­—                â”‚ â† å®æ—¶æ˜¾ç¤º
â”‚ å·²è´­ä¹°: 0å­—                        â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ å¯ç”¨æ€»å­—æ•°: 500,000å­—              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ è®¢é˜…ä»»æ„ä¼šå‘˜å¥—é¤å¯è·èµ 50ä¸‡å­—   â”‚
â”‚    æœ‰æ•ˆæœŸä¸ä¼šå‘˜æ—¶é•¿ä¸€è‡´            â”‚ â† æ©™è‰²æç¤ºå¡ç‰‡
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**äº¤äº’**: ç‚¹å‡»å¡ç‰‡è·³è½¬åˆ°ä¼šå‘˜è®¢é˜…é¡µé¢

### èµ é€é€»è¾‘

**è§¦å‘æ—¶æœº**:
- âœ… ç”¨æˆ·è®¢é˜…VIPæ—¶è‡ªåŠ¨èµ é€
- âœ… åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æŸ¥å’Œåˆ·æ–°
- âœ… VIPç»­è´¹æ—¶æ›´æ–°è¿‡æœŸæ—¶é—´
- âœ… VIPåˆ°æœŸåèµ é€å­—æ•°å¤±æ•ˆ

**æ ¸å¿ƒä»£ç **:
```objective-c
- (void)refreshVIPGiftedWords {
    BOOL isVIP = [[AIUAIAPManager sharedManager] isVIPMember];
    
    if (isVIP) {
        NSInteger currentGiftedWords = [...];
        
        if (currentGiftedWords == 0) {
            // æ–°è®¢é˜…ï¼Œèµ é€50ä¸‡å­—
            [[NSUserDefaults standardUserDefaults] setInteger:500000 
                                                       forKey:kAIUAVIPGiftedWords];
        }
        
        // æ›´æ–°è¿‡æœŸæ—¶é—´ä¸ºVIPåˆ°æœŸæ—¶é—´
        NSDate *vipExpiryDate = [[AIUAIAPManager sharedManager] subscriptionExpiryDate];
        [[NSUserDefaults standardUserDefaults] setObject:vipExpiryDate 
                                                   forKey:kAIUAVIPGiftedWordsExpiryDate];
    }
}
```

---

## âœ… éœ€æ±‚3ï¼šé›†æˆçœŸå®IAPè´­ä¹°é€»è¾‘

### äº§å“é…ç½®

**App Store Connect é…ç½®**:

| äº§å“ID | æ˜¾ç¤ºåç§° | ç±»å‹ | ä»·æ ¼ | å­—æ•° |
|--------|---------|------|------|------|
| `com.yourcompany.aiassistant.wordpack.500k` | 500,000å­—æ•°åŒ… | æ¶ˆè€—å‹ | Â¥6 | 500,000 |
| `com.yourcompany.aiassistant.wordpack.2m` | 2,000,000å­—æ•°åŒ… | æ¶ˆè€—å‹ | Â¥18 | 2,000,000 |
| `com.yourcompany.aiassistant.wordpack.6m` | 6,000,000å­—æ•°åŒ… | æ¶ˆè€—å‹ | Â¥38 | 6,000,000 |

### IAPè´­ä¹°æµç¨‹

```
ç”¨æˆ·é€‰æ‹©å­—æ•°åŒ…
    â†“
ç¡®è®¤è´­ä¹°å¼¹çª—
    â†“
è°ƒç”¨ AIUAWordPackManager.purchaseWordPack:
    â†“
è°ƒç”¨ AIUAIAPManager.purchaseConsumableProduct: âœ¨ æ–°æ–¹æ³•
    â†“
StoreKit IAPè´­ä¹°æµç¨‹
    â”œâ”€ è·å–äº§å“ä¿¡æ¯
    â”œâ”€ æ·»åŠ æ”¯ä»˜è¯·æ±‚
    â”œâ”€ å¤„ç†äº¤æ˜“çŠ¶æ€
    â””â”€ éªŒè¯æ”¶æ®ï¼ˆå¯é€‰ï¼‰
    â†“
è´­ä¹°æˆåŠŸ
    â”œâ”€ æ·»åŠ è´­ä¹°è®°å½•ï¼ˆ90å¤©æœ‰æ•ˆæœŸï¼‰
    â”œâ”€ åŒæ­¥åˆ°iCloud
    â”œâ”€ å‘é€é€šçŸ¥
    â””â”€ åˆ·æ–°UI
```

### å…³é”®å®ç°

#### AIUAIAPManager æ–°å¢æ–¹æ³•

```objective-c
- (void)purchaseConsumableProduct:(NSString *)productID 
                       completion:(AIUAIAPPurchaseCompletion)completion {
    // æ£€æŸ¥IAPå¯ç”¨æ€§
    if (![SKPaymentQueue canMakePayments]) {
        completion(NO, L(@"iap_not_supported"));
        return;
    }
    
    // æ£€æŸ¥äº§å“ç¼“å­˜
    SKProduct *product = self.productsCache[productID];
    
    if (!product) {
        // å¼‚æ­¥è·å–äº§å“ä¿¡æ¯
        SKProductsRequest *request = [[SKProductsRequest alloc] 
            initWithProductIdentifiers:[NSSet setWithObject:productID]];
        request.delegate = self;
        [request start];
        return;
    }
    
    // å‘èµ·è´­ä¹°
    [self addPaymentForProduct:product];
}
```

#### AIUAWordPackManager è°ƒç”¨

```objective-c
[[AIUAIAPManager sharedManager] purchaseConsumableProduct:productID 
    completion:^(BOOL success, NSString *errorMessage) {
    
    if (success) {
        // æˆåŠŸï¼šä¿å­˜è®°å½• + iCloudåŒæ­¥ + å‘é€é€šçŸ¥
    } else {
        // å¤±è´¥ï¼šè½¬æ¢é”™è¯¯å¹¶å›è°ƒ
        NSError *error = [NSError errorWithDomain:@"AIUAWordPackManager"
                                             code:-1
                                         userInfo:@{NSLocalizedDescriptionKey: errorMessage}];
        completion(NO, error);
    }
}];
```

---

## âœ… éœ€æ±‚4ï¼šiCloudäº‘ç«¯è®°å½•

### iCloudæ•°æ®ç»“æ„

```objective-c
// iCloud Key-Value Store
NSUbiquitousKeyValueStore *iCloudStore = [NSUbiquitousKeyValueStore defaultStore];

// æ•°æ®ç»“æ„
NSDictionary *data = @{
    // VIPèµ é€å­—æ•°
    @"vipGiftedWords": @500000,
    @"vipGiftedWordsExpiryDate": [NSDate date],
    
    // è´­ä¹°è®°å½•
    @"purchases": @[
        @{
            @"productID": @"com.xxx.wordpack.500k",
            @"words": @500000,
            @"remainingWords": @450000,
            @"purchaseDate": [NSDate date],
            @"expiryDate": [NSDate date]  // 90å¤©å
        }
    ],
    
    // ç´¯è®¡æ¶ˆè€—
    @"consumedWords": @50000
};
```

### è‡ªåŠ¨åŒæ­¥æœºåˆ¶

#### åŒæ­¥è§¦å‘æ—¶æœº

```
åº”ç”¨å¯åŠ¨
    â†“
enableiCloudSyncï¼ˆåº”ç”¨æ¿€æ´»æ—¶ï¼‰
    â”œâ”€ ç›‘å¬iCloudå˜åŒ–é€šçŸ¥
    â”œâ”€ é¦–æ¬¡åŒæ­¥ï¼šä»iCloudä¸‹è½½
    â””â”€ åˆå¹¶æœ¬åœ°å’Œäº‘ç«¯æ•°æ®
    â†“
ç”¨æˆ·è´­ä¹°å­—æ•°åŒ…
    â†“
syncToiCloudï¼ˆè‡ªåŠ¨ä¸Šä¼ ï¼‰
    â†“
ç”¨æˆ·æ¶ˆè€—å­—æ•°
    â†“
syncToiCloudï¼ˆè‡ªåŠ¨ä¸Šä¼ ï¼‰
    â†“
å…¶ä»–è®¾å¤‡æ£€æµ‹åˆ°iCloudå˜åŒ–
    â†“
syncFromiCloudï¼ˆè‡ªåŠ¨ä¸‹è½½ï¼‰
    â†“
å®æ—¶åŒæ­¥å®Œæˆ
```

#### æ ¸å¿ƒå®ç°

```objective-c
// å¯ç”¨åŒæ­¥
- (void)enableiCloudSync {
    self.iCloudSyncEnabled = YES;
    self.iCloudStore = [NSUbiquitousKeyValueStore defaultStore];
    
    // ç›‘å¬iCloudå˜åŒ–
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(iCloudStoreDidChange:)
                                                 name:NSUbiquitousKeyValueStoreDidChangeExternallyNotification
                                               object:self.iCloudStore];
    
    [self.iCloudStore synchronize];
    [self syncFromiCloud];
}

// ä¸Šä¼ åˆ°iCloud
- (void)syncToiCloud {
    NSDictionary *data = @{
        @"vipGiftedWords": @([self vipGiftedWords]),
        @"purchases": [...],
        @"consumedWords": @([self consumedWords])
    };
    
    [self.iCloudStore setDictionary:data forKey:kAIUAiCloudWordPackData];
    [self.iCloudStore synchronize];
}

// ä»iCloudä¸‹è½½
- (void)syncFromiCloud {
    NSDictionary *iCloudData = [self.iCloudStore dictionaryForKey:kAIUAiCloudWordPackData];
    
    // åŒæ­¥åˆ°æœ¬åœ°
    [[NSUserDefaults standardUserDefaults] setInteger:[iCloudData[@"vipGiftedWords"] integerValue]
                                               forKey:kAIUAVIPGiftedWords];
    // ... å…¶ä»–æ•°æ®
}
```

### Xcodeé…ç½®

**æ­¥éª¤**:
1. Target â†’ Signing & Capabilities
2. ç‚¹å‡» "+ Capability"
3. é€‰æ‹© "iCloud"
4. å‹¾é€‰ "Key-value storage" âœ…

**å®Œæˆï¼** Xcodeä¼šè‡ªåŠ¨ç”Ÿæˆ entitlements æ–‡ä»¶ã€‚

---

## âœ… éœ€æ±‚5ï¼šå®Œæ•´å­—æ•°æ¶ˆè€—é€»è¾‘

### æ¶ˆè€—ä¼˜å…ˆçº§

```
AIç”Ÿæˆå†…å®¹ï¼ˆ1000å­—ï¼‰
    â†“
æ£€æŸ¥æ€»å­—æ•°æ˜¯å¦è¶³å¤Ÿ
    â”œâ”€ ä¸è¶³ â†’ æç¤ºè´­ä¹°
    â”‚
    â””â”€ è¶³å¤Ÿ â†’ å¼€å§‹æ¶ˆè€—
         â†“
    ä¼˜å…ˆçº§1: VIPèµ é€å­—æ•°
         â”œâ”€ æœ‰500,000å­—
         â”œâ”€ æ¶ˆè€—1,000å­—
         â””â”€ å‰©ä½™499,000å­—
         â†“
    ä¼˜å…ˆçº§2: è´­ä¹°å­—æ•°åŒ…ï¼ˆæŒ‰è´­ä¹°æ—¶é—´æ’åºï¼‰
         â”œâ”€ æ£€æŸ¥è¿‡æœŸæ—¶é—´
         â”œâ”€ ä»æœ€æ—©è´­ä¹°çš„å¼€å§‹æ¶ˆè€—
         â””â”€ æ›´æ–°å‰©ä½™å­—æ•°
         â†“
    æ›´æ–°ç´¯è®¡æ¶ˆè€—
         â†“
    åŒæ­¥åˆ°iCloud
         â†“
    å‘é€é€šçŸ¥æ›´æ–°UI
```

### æ ¸å¿ƒå®ç°

```objective-c
- (void)consumeWords:(NSInteger)words 
          completion:(void(^)(BOOL, NSInteger))completion {
    
    // 1. æ£€æŸ¥å­—æ•°æ˜¯å¦è¶³å¤Ÿ
    if (![self hasEnoughWords:words]) {
        completion(NO, [self totalAvailableWords]);
        return;
    }
    
    NSInteger remainingToConsume = words;
    
    // 2. ä¼˜å…ˆä»VIPèµ é€å­—æ•°ä¸­æ¶ˆè€—
    NSInteger vipWords = [self vipGiftedWords];
    if (vipWords > 0) {
        NSInteger consumeFromVIP = MIN(remainingToConsume, vipWords);
        NSInteger newVIPWords = vipWords - consumeFromVIP;
        
        [[NSUserDefaults standardUserDefaults] setInteger:newVIPWords 
                                                   forKey:kAIUAVIPGiftedWords];
        remainingToConsume -= consumeFromVIP;
    }
    
    // 3. ä»è´­ä¹°å­—æ•°åŒ…ä¸­æ¶ˆè€—
    if (remainingToConsume > 0) {
        [self consumeFromPurchasedPacks:remainingToConsume];
    }
    
    // 4. æ›´æ–°ç´¯è®¡æ¶ˆè€—
    NSInteger totalConsumed = [...] + words;
    [[NSUserDefaults standardUserDefaults] setInteger:totalConsumed 
                                               forKey:kAIUAConsumedWords];
    
    // 5. åŒæ­¥åˆ°iCloud
    [self syncToiCloud];
    
    // 6. å‘é€é€šçŸ¥
    [[NSNotificationCenter defaultCenter] postNotificationName:AIUAWordConsumedNotification ...];
    
    completion(YES, [self totalAvailableWords]);
}
```

### å­—æ•°è®¡ç®—å…¬å¼

**å¯ç”¨æ€»å­—æ•°**:
```
æ€»å­—æ•° = VIPèµ é€å‰©ä½™ + Î£(è´­ä¹°å­—æ•°åŒ…å‰©ä½™ä¸”æœªè¿‡æœŸ)
```

**ç¤ºä¾‹**:
```
VIPèµ é€: 500,000å­—ï¼ˆæœªè¿‡æœŸï¼‰
è´­ä¹°1: 500,000å­—ï¼ˆæœªè¿‡æœŸï¼‰
è´­ä¹°2: 200,000å­—ï¼ˆå·²è¿‡æœŸï¼‰âŒ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡: 1,000,000å­—
```

### è¿‡æœŸç®¡ç†

**VIPèµ é€å­—æ•°**:
- è¿‡æœŸæ—¶é—´ = VIPä¼šå‘˜åˆ°æœŸæ—¶é—´
- ä¼šå‘˜ç»­è´¹ â†’ è‡ªåŠ¨å»¶é•¿è¿‡æœŸæ—¶é—´
- ä¼šå‘˜åˆ°æœŸ â†’ èµ é€å­—æ•°å¤±æ•ˆ

**è´­ä¹°å­—æ•°åŒ…**:
- è¿‡æœŸæ—¶é—´ = è´­ä¹°æ—¶é—´ + 90å¤©
- è¿‡æœŸåè‡ªåŠ¨ä»æ€»å­—æ•°ä¸­æ’é™¤
- æ¶ˆè€—æ—¶è‡ªåŠ¨è·³è¿‡è¿‡æœŸå­—æ•°åŒ…

---

## ğŸ“‚ æ–°å¢æ–‡ä»¶æ¸…å•

### æ ¸å¿ƒä»£ç æ–‡ä»¶

âœ… **AIUAWordPackManager.h** (126è¡Œ)
- å­—æ•°åŒ…ç®¡ç†å™¨å¤´æ–‡ä»¶
- å®šä¹‰æ¥å£å’Œæšä¸¾

âœ… **AIUAWordPackManager.m** (483è¡Œ)
- å­—æ•°æŸ¥è¯¢ï¼švipGiftedWords, purchasedWords, totalAvailableWords
- å­—æ•°åŒ…è´­ä¹°ï¼špurchaseWordPack
- VIPèµ é€ï¼šrefreshVIPGiftedWords
- å­—æ•°æ¶ˆè€—ï¼šconsumeWords, consumeFromPurchasedPacks
- iCloudåŒæ­¥ï¼šenableiCloudSync, syncToiCloud, syncFromiCloud

âœ… **AIUAWordPackViewController.h** (18è¡Œ)
- å­—æ•°åŒ…è´­ä¹°é¡µé¢å¤´æ–‡ä»¶

âœ… **AIUAWordPackViewController.m** (519è¡Œ)
- å­—æ•°ä¿¡æ¯æ˜¾ç¤ºï¼ˆ3è¡Œæ•°æ®ï¼‰
- VIPèµ é€æç¤ºå¡ç‰‡
- å­—æ•°åŒ…é€‰æ‹©ï¼ˆ3ä¸ªé€‰é¡¹ï¼‰
- è´­ä¹°æŒ‰é’®å’Œæµç¨‹
- è´­ä¹°é¡»çŸ¥å±•ç¤º

âœ… **AIUAVIPManager.h** (51è¡Œ)
- VIPæƒé™ç®¡ç†å™¨å¤´æ–‡ä»¶

âœ… **AIUAVIPManager.m** (115è¡Œ)
- VIPæƒé™æ£€æŸ¥
- å¼¹çª—æç¤º
- å¯¼èˆªåˆ°ä¼šå‘˜é¡µé¢

### æ–‡æ¡£æ–‡ä»¶

âœ… **VIP_PERMISSION_SYSTEM.md** - VIPæƒé™ç³»ç»Ÿå®Œæ•´æ–‡æ¡£  
âœ… **WORD_PACK_FEATURE.md** - å­—æ•°åŒ…åŠŸèƒ½éœ€æ±‚æ–‡æ¡£  
âœ… **WORD_PACK_SYSTEM_COMPLETE.md** - å­—æ•°åŒ…ç³»ç»Ÿå®ç°æ–‡æ¡£  
âœ… **WORD_PACK_QUICK_START.md** - å¿«é€Ÿå¼€å§‹æŒ‡å—  
âœ… **WORD_PACK_IAP_FIX.md** - IAPç±»å‹åŒ¹é…ä¿®å¤æ–‡æ¡£  
âœ… **FINAL_IMPLEMENTATION_SUMMARY.md** - æœ€ç»ˆå®ç°æ€»ç»“ï¼ˆæœ¬æ–‡æ¡£ï¼‰

---

## ğŸ”§ ä¿®æ”¹æ–‡ä»¶æ¸…å•

### ä»£ç æ–‡ä»¶

âœ… **AIUAIAPManager.h**
- æ–°å¢ `purchaseConsumableProduct:completion:` æ–¹æ³•

âœ… **AIUAIAPManager.m**
- å®ç°æ¶ˆè€—å‹äº§å“è´­ä¹°æ–¹æ³•

âœ… **AIUAHotViewController.m**
- æ·»åŠ VIPæƒé™æ£€æŸ¥ï¼ˆç‚¹å‡»æ¨¡æ¿æ—¶ï¼‰

âœ… **AIUAWriterViewController.m**
- æ·»åŠ VIPæƒé™æ£€æŸ¥ï¼ˆå¼€å§‹åˆ›ä½œæ—¶ï¼‰

âœ… **AIUADocDetailViewController.m**
- æ·»åŠ VIPæƒé™æ£€æŸ¥ï¼ˆç»­å†™ã€æ”¹å†™ã€æ‰©å†™ã€ç¿»è¯‘ï¼‰

âœ… **AIUASettingsViewController.m**
- æ·»åŠ å­—æ•°åŒ…é¡µé¢å…¥å£

âœ… **AppDelegate.m**
- å¯ç”¨iCloudåŒæ­¥
- åˆ·æ–°VIPèµ é€å­—æ•°

### æœ¬åœ°åŒ–æ–‡ä»¶

âœ… **zh-Hans.lproj/Localizable.strings**
- æ–°å¢20+å­—æ•°åŒ…ç›¸å…³é”®
- æ–°å¢VIPæƒé™æç¤ºé”®

âœ… **en.lproj/Localizable.strings**
- å®Œæ•´å¯¹åº”çš„è‹±æ–‡ç¿»è¯‘

---

## ğŸ¯ æ¶æ„è®¾è®¡

### ä¸‰å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         UI Layer                     â”‚
â”‚  AIUAWordPackViewController          â”‚
â”‚  (æ˜¾ç¤ºã€äº¤äº’ã€è´­ä¹°)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Business Layer                  â”‚
â”‚  AIUAWordPackManager                 â”‚
â”‚  (å­—æ•°ç®¡ç†ã€æ¶ˆè€—é€»è¾‘ã€åŒæ­¥)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Data Layer                     â”‚
â”‚  AIUAIAPManager + NSUserDefaults     â”‚
â”‚  + NSUbiquitousKeyValueStore         â”‚
â”‚  (IAPè´­ä¹°ã€æœ¬åœ°å­˜å‚¨ã€äº‘ç«¯åŒæ­¥)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å•ä¾‹æ¨¡å¼

æ‰€æœ‰ç®¡ç†å™¨éƒ½ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼š
- `[AIUAWordPackManager sharedManager]`
- `[AIUAIAPManager sharedManager]`
- `[AIUAVIPManager sharedManager]`

### é€šçŸ¥æœºåˆ¶

```objective-c
// VIPè®¢é˜…çŠ¶æ€å˜åŒ–
AIUASubscriptionStatusChanged
    â†“
è‡ªåŠ¨åˆ·æ–°VIPèµ é€å­—æ•°

// å­—æ•°åŒ…è´­ä¹°
AIUAWordPackPurchasedNotification
    â†“
æ›´æ–°UIæ˜¾ç¤º

// å­—æ•°æ¶ˆè€—
AIUAWordConsumedNotification
    â†“
åˆ·æ–°å­—æ•°æ˜¾ç¤º
```

---

## ğŸ“Š æ•°æ®æµç¨‹

### å®Œæ•´æ•°æ®æµ

```
ç”¨æˆ·æ“ä½œ
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è®¢é˜…VIP                         â”‚
â”‚ â†“                               â”‚
â”‚ refreshVIPGiftedWords           â”‚
â”‚ â”œâ”€ èµ é€50ä¸‡å­—                   â”‚
â”‚ â”œâ”€ è®¾ç½®è¿‡æœŸæ—¶é—´                 â”‚
â”‚ â””â”€ syncToiCloud â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â†“                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ è´­ä¹°å­—æ•°åŒ…                      â”‚â”‚
â”‚ â†“                               â”‚â”‚
â”‚ purchaseWordPack               â”‚â”‚
â”‚ â”œâ”€ IAPè´­ä¹°æµç¨‹                  â”‚â”‚
â”‚ â”œâ”€ æ·»åŠ è´­ä¹°è®°å½•ï¼ˆ90å¤©ï¼‰          â”‚â”‚
â”‚ â””â”€ syncToiCloud â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚â”‚
    â†“                             â”‚â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚
â”‚ AIç”Ÿæˆå†…å®¹                      â”‚â”‚â”‚
â”‚ â†“                               â”‚â”‚â”‚
â”‚ consumeWords                   â”‚â”‚â”‚
â”‚ â”œâ”€ ä¼˜å…ˆæ¶ˆè€—VIPèµ é€              â”‚â”‚â”‚
â”‚ â”œâ”€ å…¶æ¬¡æ¶ˆè€—è´­ä¹°å­—æ•°åŒ…            â”‚â”‚â”‚
â”‚ â”œâ”€ æ›´æ–°ç´¯è®¡æ¶ˆè€—                 â”‚â”‚â”‚
â”‚ â””â”€ syncToiCloud â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â”‚â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚â”‚â”‚
    â†“                             â”‚â”‚â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚â”‚
â”‚         iCloud                  â”‚â”‚â”‚â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚â”‚â”‚
â”‚  â”‚ AIUAWordPackData          â”‚â—„â”˜â”‚â”‚
â”‚  â”‚ - vipGiftedWords          â”‚â—„â”€â”˜â”‚
â”‚  â”‚ - purchases               â”‚â—„â”€â”€â”˜
â”‚  â”‚ - consumedWords           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚         â†“ åŒæ­¥åˆ°å…¶ä»–è®¾å¤‡
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚ è®¾å¤‡Bè‡ªåŠ¨ä¸‹è½½             â”‚
â”‚  â”‚ syncFromiCloud            â”‚
â”‚  â”‚ æ›´æ–°æœ¬åœ°æ•°æ®              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§ª å®Œæ•´æµ‹è¯•æµç¨‹

### æµ‹è¯•åœºæ™¯1ï¼šVIPèµ é€

**æ­¥éª¤**:
```
1. æ£€æŸ¥åˆå§‹çŠ¶æ€ï¼ˆéVIPï¼‰
   VIPèµ é€: 0å­— âœ“
   
2. è®¢é˜…VIP
   
3. æ£€æŸ¥èµ é€å­—æ•°
   VIPèµ é€: 500,000å­— âœ“
   
4. ç­‰å¾…VIPåˆ°æœŸ
   
5. æ£€æŸ¥èµ é€å­—æ•°
   VIPèµ é€: 0å­—ï¼ˆå·²è¿‡æœŸï¼‰âœ“
```

### æµ‹è¯•åœºæ™¯2ï¼šå­—æ•°åŒ…è´­ä¹°

**æ­¥éª¤**:
```
1. é€‰æ‹©500Kå­—æ•°åŒ…
   
2. ç‚¹å‡»è´­ä¹°
   
3. å®ŒæˆIAPæ”¯ä»˜
   
4. æ£€æŸ¥å­—æ•°
   è´­ä¹°å­—æ•°: 500,000å­— âœ“
   
5. æ£€æŸ¥è´­ä¹°è®°å½•
   è¿‡æœŸæ—¶é—´: è´­ä¹°æ—¥æœŸ+90å¤© âœ“
```

### æµ‹è¯•åœºæ™¯3ï¼šå­—æ•°æ¶ˆè€—

**æ­¥éª¤**:
```
åˆå§‹çŠ¶æ€:
- VIPèµ é€: 500,000å­—
- è´­ä¹°å­—æ•°: 500,000å­—
- æ€»è®¡: 1,000,000å­—

æ¶ˆè€—600,000å­—:
    â†“
ä¼˜å…ˆçº§1: æ¶ˆè€—VIPèµ é€500,000å­—
- VIPèµ é€: 0å­— âœ“
- å‰©ä½™éœ€æ¶ˆè€—: 100,000å­—
    â†“
ä¼˜å…ˆçº§2: æ¶ˆè€—è´­ä¹°å­—æ•°100,000å­—
- è´­ä¹°å­—æ•°: 400,000å­— âœ“
    â†“
ç»“æœ:
- VIPèµ é€: 0å­— âœ“
- è´­ä¹°å­—æ•°: 400,000å­— âœ“
- æ€»è®¡: 400,000å­— âœ“
- ç´¯è®¡æ¶ˆè€—: 600,000å­— âœ“
```

### æµ‹è¯•åœºæ™¯4ï¼šiCloudåŒæ­¥

**æ­¥éª¤**:
```
è®¾å¤‡A:
1. è®¢é˜…VIPï¼ˆèµ é€500,000å­—ï¼‰
2. è´­ä¹°500Kå­—æ•°åŒ…
3. æ¶ˆè€—100,000å­—
4. æ•°æ®è‡ªåŠ¨ä¸Šä¼ iCloud

è®¾å¤‡Bï¼ˆåŒä¸€Apple IDï¼‰:
1. å¯åŠ¨åº”ç”¨
2. iCloudè‡ªåŠ¨ä¸‹è½½æ•°æ®
3. æ£€æŸ¥å­—æ•°
   - VIPèµ é€: 400,000å­— âœ“
   - è´­ä¹°å­—æ•°: 500,000å­— âœ“
   - æ€»è®¡: 900,000å­— âœ“
```

### æµ‹è¯•åœºæ™¯5ï¼šè¿‡æœŸç®¡ç†

**æ­¥éª¤**:
```
1. è´­ä¹°500Kå­—æ•°åŒ…
   è¿‡æœŸæ—¶é—´: 2025-11-11 + 90å¤© = 2026-02-09
   
2. ä¿®æ”¹ç³»ç»Ÿæ—¶é—´åˆ°2026-02-10
   
3. æ£€æŸ¥å­—æ•°
   è´­ä¹°å­—æ•°: 0å­—ï¼ˆå·²è¿‡æœŸï¼‰âœ“
   
4. VIPèµ é€åŒç†æµ‹è¯•
```

---

## ğŸ”” é€šçŸ¥ç³»ç»Ÿ

### é€šçŸ¥åˆ—è¡¨

```objective-c
// 1. VIPè®¢é˜…çŠ¶æ€å˜åŒ–ï¼ˆå·²å­˜åœ¨ï¼‰
NSString * const AIUASubscriptionStatusChanged = @"AIUASubscriptionStatusChanged";
â†’ è§¦å‘ï¼šrefreshVIPGiftedWords

// 2. å­—æ•°åŒ…è´­ä¹°ï¼ˆæ–°å¢ï¼‰
NSString * const AIUAWordPackPurchasedNotification = @"AIUAWordPackPurchasedNotification";
â†’ è§¦å‘ï¼šæ›´æ–°UIå­—æ•°æ˜¾ç¤º

// 3. å­—æ•°æ¶ˆè€—ï¼ˆæ–°å¢ï¼‰
NSString * const AIUAWordConsumedNotification = @"AIUAWordConsumedNotification";
â†’ è§¦å‘ï¼šæ›´æ–°UIå­—æ•°æ˜¾ç¤º

// 4. iCloudåŒæ­¥å˜åŒ–ï¼ˆç³»ç»Ÿï¼‰
NSUbiquitousKeyValueStoreDidChangeExternallyNotification
â†’ è§¦å‘ï¼šsyncFromiCloud
```

### ç›‘å¬ç¤ºä¾‹

```objective-c
// åœ¨å­—æ•°åŒ…é¡µé¢ç›‘å¬
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(updateWordsDisplay)
                                             name:AIUAWordPackPurchasedNotification
                                           object:nil];

[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(updateWordsDisplay)
                                             name:AIUAWordConsumedNotification
                                           object:nil];
```

---

## ğŸ“ é›†æˆåˆ°å†™ä½œåŠŸèƒ½

### åœ¨AIç”Ÿæˆå‰æ£€æŸ¥

```objective-c
// AIUAWritingDetailViewController.m
- (void)startGeneration {
    // ä¼°ç®—å­—æ•°ï¼ˆå¯é€‰ï¼‰
    NSInteger estimatedWords = self.wordCount > 0 ? self.wordCount : 1000;
    
    // æ£€æŸ¥å­—æ•°æ˜¯å¦è¶³å¤Ÿ
    if (![[AIUAWordPackManager sharedManager] hasEnoughWords:estimatedWords]) {
        [self showInsufficientWordsAlert];
        return;
    }
    
    // ç»§ç»­ç”Ÿæˆ
    [self performGeneration];
}
```

### åœ¨AIç”Ÿæˆåæ¶ˆè€—

```objective-c
// ç”Ÿæˆå®Œæˆå›è°ƒ
- (void)onGenerationComplete:(NSString *)content {
    // è®¡ç®—å®é™…ç”Ÿæˆçš„å­—æ•°
    NSInteger actualWords = content.length;
    
    // æ¶ˆè€—å­—æ•°
    [[AIUAWordPackManager sharedManager] consumeWords:actualWords 
                                            completion:^(BOOL success, NSInteger remaining) {
        if (success) {
            NSLog(@"å­—æ•°æ¶ˆè€—æˆåŠŸï¼Œå‰©ä½™: %ld", (long)remaining);
        } else {
            // ç†è®ºä¸Šä¸åº”è¯¥å‘ç”Ÿï¼ˆå‰é¢å·²æ£€æŸ¥è¿‡ï¼‰
            NSLog(@"å­—æ•°æ¶ˆè€—å¤±è´¥");
        }
    }];
}
```

### å­—æ•°ä¸è¶³æç¤º

```objective-c
- (void)showInsufficientWordsAlert {
    UIAlertController *alert = [UIAlertController 
        alertControllerWithTitle:L(@"insufficient_words")
        message:L(@"insufficient_words_message")
        preferredStyle:UIAlertControllerStyleAlert];
    
    // "è´­ä¹°å­—æ•°åŒ…"æŒ‰é’®
    UIAlertAction *buyPackAction = [UIAlertAction 
        actionWithTitle:L(@"purchase_word_pack")
        style:UIAlertActionStyleDefault
        handler:^(UIAlertAction *action) {
            AIUAWordPackViewController *vc = [[AIUAWordPackViewController alloc] init];
            vc.hidesBottomBarWhenPushed = YES;
            [self.navigationController pushViewController:vc animated:YES];
        }];
    
    // "å¼€é€šä¼šå‘˜"æŒ‰é’®ï¼ˆèµ é€50ä¸‡å­—ï¼‰
    UIAlertAction *vipAction = [UIAlertAction 
        actionWithTitle:L(@"activate_membership")
        style:UIAlertActionStyleDefault
        handler:^(UIAlertAction *action) {
            AIUAMembershipViewController *vc = [[AIUAMembershipViewController alloc] init];
            vc.hidesBottomBarWhenPushed = YES;
            [self.navigationController pushViewController:vc animated:YES];
        }];
    
    [alert addAction:buyPackAction];
    [alert addAction:vipAction];
    [alert addAction:[UIAlertAction actionWithTitle:L(@"cancel") 
                                              style:UIAlertActionStyleCancel 
                                            handler:nil]];
    
    [self presentViewController:alert animated:YES completion:nil];
}
```

---

## ğŸ¨ UIå±•ç¤ºæ•ˆæœ

### å­—æ•°åŒ…é¡µé¢å®Œæ•´å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [<] åˆ›ä½œå­—æ•°åŒ…                      â”‚ â† å¯¼èˆªæ 
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ä¼šå‘˜èµ é€: 500,000å­—            â”‚ â”‚ â† å­—æ•°ä¿¡æ¯
â”‚  â”‚ å·²è´­ä¹°: 0å­—                    â”‚ â”‚   ç°è‰²å¡ç‰‡
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â”‚
â”‚  â”‚ å¯ç”¨æ€»å­—æ•°: 500,000å­—          â”‚ â”‚   ç»¿è‰²åŠ ç²—
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ è®¢é˜…ä»»æ„ä¼šå‘˜å¥—é¤å¯è·èµ 50ä¸‡å­—â”‚ â”‚ â† VIPæç¤º
â”‚  â”‚    æœ‰æ•ˆæœŸä¸ä¼šå‘˜æ—¶é•¿ä¸€è‡´        â”‚ â”‚   æ©™è‰²å¡ç‰‡
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   å¯ç‚¹å‡»
â”‚                                      â”‚
â”‚  ğŸ’° è´­ä¹°å­—æ•°åŒ…                      â”‚ â† æ ‡é¢˜
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ âœ“ 500,000å­—         Â¥6        â”‚ â”‚ â† å·²é€‰ä¸­
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   ç»¿è‰²è¾¹æ¡†
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ â—‹ 2,000,000å­—       Â¥18       â”‚ â”‚ â† æœªé€‰ä¸­
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   ç°è‰²è¾¹æ¡†
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ â—‹ 6,000,000å­—       Â¥38       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                      â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚      â”‚ ç«‹å³å¼€é€š     â”‚              â”‚ â† è´­ä¹°æŒ‰é’®
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   ç»¿è‰²
â”‚                                      â”‚
â”‚  ğŸ’° è´­ä¹°é¡»çŸ¥                        â”‚ â† è¯´æ˜æ ‡é¢˜
â”‚  â€¢ å­—æ•°åŒ…è´­ä¹°å90å¤©å†…æœ‰æ•ˆ...        â”‚
â”‚  â€¢ ä½¿ç”¨æ—¶å°†ä¼˜å…ˆæ¶ˆè€—ä¼šå‘˜èµ é€...      â”‚
â”‚  â€¢ å­—æ•°ç»Ÿè®¡è§„åˆ™...                  â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”’ å®‰å…¨æ€§

### æ•°æ®éªŒè¯

âœ… **IAPæ”¶æ®éªŒè¯** - æœ¬åœ°éªŒè¯ + æœåŠ¡å™¨éªŒè¯ï¼ˆå¯é€‰ï¼‰  
âœ… **è¿‡æœŸæ£€æŸ¥** - æ¯æ¬¡æŸ¥è¯¢æ—¶æ£€æŸ¥è¿‡æœŸ  
âœ… **è¶Šç‹±æ£€æµ‹** - é˜»æ­¢è¶Šç‹±è®¾å¤‡ä½¿ç”¨  
âœ… **Bundle IDéªŒè¯** - ç¡®ä¿æ”¶æ®å±äºå½“å‰åº”ç”¨  

### æ•°æ®åŒæ­¥å®‰å…¨

âœ… **Apple IDå…³è”** - é€šè¿‡Apple IDåŒæ­¥ï¼Œç¡®ä¿ç”¨æˆ·èº«ä»½  
âœ… **åŠ å¯†ä¼ è¾“** - iCloudè‡ªåŠ¨åŠ å¯†  
âœ… **é˜²ç¯¡æ”¹** - ä½¿ç”¨ç³»ç»ŸAPIï¼Œé˜²æ­¢æœ¬åœ°ç¯¡æ”¹  

---

## ğŸ“± ç”¨æˆ·ä½“éªŒ

### ä¼˜ç‚¹

ğŸŒŸ **è‡ªåŠ¨åŒæ­¥** - æ— éœ€æ‰‹åŠ¨æ“ä½œï¼Œè·¨è®¾å¤‡è‡ªåŠ¨åŒæ­¥  
ğŸŒŸ **ä¼˜å…ˆçº§æ¸…æ™°** - VIPèµ é€ä¼˜å…ˆæ¶ˆè€—  
ğŸŒŸ **æç¤ºæ˜ç¡®** - å­—æ•°ä¸è¶³æ—¶æ¸…æ™°å¼•å¯¼  
ğŸŒŸ **å®æ—¶æ›´æ–°** - è´­ä¹°å’Œæ¶ˆè€—åç«‹å³åˆ·æ–°UI  
ğŸŒŸ **è¿‡æœŸç®¡ç†** - è‡ªåŠ¨å¤±æ•ˆï¼Œä¸è®¡å…¥æ€»å­—æ•°  

### å®Œæ•´ç”¨æˆ·æ—…ç¨‹

```
æ–°ç”¨æˆ·ä¸‹è½½åº”ç”¨
    â†“
ä½¿ç”¨å…è´¹åŠŸèƒ½
    â†“
æƒ³ä½¿ç”¨AIå†™ä½œ â†’ VIPæƒé™æç¤º
    â”œâ”€ é€‰æ‹©1: è®¢é˜…VIP
    â”‚   â†“
    â”‚   èµ é€50ä¸‡å­—
    â”‚   â†“
    â”‚   å¼€å§‹åˆ›ä½œ
    â”‚   â†“
    â”‚   å­—æ•°é€æ¸æ¶ˆè€—
    â”‚   â†“
    â”‚   VIPåˆ°æœŸ â†’ èµ é€å­—æ•°å¤±æ•ˆ
    â”‚
    â””â”€ é€‰æ‹©2: è´­ä¹°å­—æ•°åŒ…
        â†“
        é€‰æ‹©å¥—é¤ï¼ˆ500K/2M/6Mï¼‰
        â†“
        æ”¯ä»˜è´­ä¹°
        â†“
        è·å¾—å­—æ•°ï¼ˆ90å¤©æœ‰æ•ˆï¼‰
        â†“
        å¼€å§‹åˆ›ä½œ
        â†“
        å­—æ•°é€æ¸æ¶ˆè€—
        â†“
        å­—æ•°åŒ…åˆ°æœŸæˆ–ç”¨å®Œ
        â†“
        å†æ¬¡è´­ä¹°
```

---

## âœ… éªŒè¯ç»“æœ

### ä»£ç è´¨é‡

âœ… **æ— ç¼–è¯‘é”™è¯¯** - æ‰€æœ‰æ–‡ä»¶ç¼–è¯‘é€šè¿‡  
âœ… **æ— Linteré”™è¯¯** - ä»£ç è§„èŒƒç¬¦åˆæ ‡å‡†  
âœ… **ç±»å‹åŒ¹é…** - æ‰€æœ‰æ–¹æ³•ç­¾åæ­£ç¡®  
âœ… **å†…å­˜ç®¡ç†** - æ­£ç¡®ä½¿ç”¨weak/strong  

### åŠŸèƒ½å®Œæ•´æ€§

âœ… **æ–‡æ¡ˆæ›´æ–°** - è´­ä¹°é¡»çŸ¥4æ¡å…¨æ–°æ–‡æ¡ˆ  
âœ… **VIPèµ é€** - è®¢é˜…é€50ä¸‡å­—+æç¤ºå¡ç‰‡  
âœ… **IAPè´­ä¹°** - çœŸå®Appleå†…è´­é›†æˆ  
âœ… **iCloudåŒæ­¥** - è·¨è®¾å¤‡è‡ªåŠ¨åŒæ­¥  
âœ… **å­—æ•°æ¶ˆè€—** - ä¼˜å…ˆçº§æ¶ˆè€—+è¿‡æœŸç®¡ç†  

### æ¶æ„è®¾è®¡

âœ… **å•ä¸€èŒè´£** - æ¯ä¸ªç±»èŒè´£æ˜ç¡®  
âœ… **è§£è€¦è®¾è®¡** - UIä¸ä¸šåŠ¡é€»è¾‘åˆ†ç¦»  
âœ… **å¯æµ‹è¯•æ€§** - æ ¸å¿ƒé€»è¾‘ç‹¬ç«‹å¯æµ‹  
âœ… **å¯æ‰©å±•æ€§** - æ˜“äºæ·»åŠ æ–°å­—æ•°åŒ…ç±»å‹  

---

## ğŸ“š ç›¸å…³æ–‡æ¡£ç´¢å¼•

| æ–‡æ¡£ | ç”¨é€” |
|------|------|
| VIP_PERMISSION_SYSTEM.md | VIPæƒé™ç³»ç»Ÿå®ç° |
| WORD_PACK_SYSTEM_COMPLETE.md | å­—æ•°åŒ…ç³»ç»Ÿå®Œæ•´å®ç° |
| WORD_PACK_QUICK_START.md | å¿«é€Ÿå¼€å§‹æŒ‡å— |
| WORD_PACK_IAP_FIX.md | IAPç±»å‹åŒ¹é…ä¿®å¤ |
| IAP_SETUP_GUIDE.md | IAPé…ç½®æŒ‡å— |
| IAP_IMPLEMENTATION_SUMMARY.md | IAPå®ç°æ€»ç»“ |

---

## ğŸš€ éƒ¨ç½²æ¸…å•

### App Store Connect

- [ ] åˆ›å»º3ä¸ªæ¶ˆè€—å‹äº§å“ï¼ˆå­—æ•°åŒ…ï¼‰
- [ ] è®¾ç½®äº§å“IDã€ä»·æ ¼ã€æè¿°
- [ ] æäº¤å®¡æ ¸

### Xcodeé…ç½®

- [x] å¯ç”¨iCloud Key-value storage
- [x] æ·»åŠ StoreKit framework
- [x] é…ç½®Info.plist

### ä»£ç é›†æˆ

- [x] AIUAWordPackManager å®ç°
- [x] AIUAWordPackViewController å®ç°
- [x] AIUAVIPManager å®ç°
- [x] AppDelegate åˆå§‹åŒ–
- [x] æœ¬åœ°åŒ–å­—ç¬¦ä¸²

### å¾…é›†æˆåŠŸèƒ½

- [ ] åœ¨å†™ä½œåŠŸèƒ½ä¸­æ·»åŠ å­—æ•°æ¶ˆè€—è°ƒç”¨
- [ ] åœ¨ç”Ÿæˆå‰æ·»åŠ å­—æ•°æ£€æŸ¥
- [ ] æ·»åŠ å­—æ•°ä¸è¶³æç¤º
- [ ] åˆ›å»ºæ¶ˆè€—è®°å½•é¡µé¢ï¼ˆå¯é€‰ï¼‰

---

## ğŸ‰ æ€»ç»“

### å®ç°äº®ç‚¹

ğŸŒŸ **å®Œæ•´IAPç³»ç»Ÿ** - è®¢é˜…å‹+æ¶ˆè€—å‹åŒæ”¯æŒ  
ğŸŒŸ **VIPèµ é€æœºåˆ¶** - è®¢é˜…é€50ä¸‡å­—  
ğŸŒŸ **iCloudåŒæ­¥** - è·¨è®¾å¤‡æ— ç¼ä½“éªŒ  
ğŸŒŸ **ä¼˜å…ˆçº§æ¶ˆè€—** - æ™ºèƒ½å­—æ•°ç®¡ç†  
ğŸŒŸ **è¿‡æœŸç®¡ç†** - è‡ªåŠ¨å¤±æ•ˆä¿æŠ¤  
ğŸŒŸ **æœ¬åœ°åŒ–æ”¯æŒ** - ä¸­è‹±æ–‡åŒè¯­  
ğŸŒŸ **è¯¦ç»†æ–‡æ¡£** - å®Œæ•´å®ç°å’Œä½¿ç”¨æŒ‡å—  

### æŠ€æœ¯æ ˆ

- **IAP**: StoreKit Framework
- **åŒæ­¥**: iCloud Key-Value Store
- **å­˜å‚¨**: NSUserDefaults
- **é€šçŸ¥**: NSNotificationCenter
- **UI**: UIKit + Masonry

### ä»£ç ç»Ÿè®¡

- **æ–°å¢æ–‡ä»¶**: 6ä¸ªæ ¸å¿ƒä»£ç æ–‡ä»¶
- **ä¿®æ”¹æ–‡ä»¶**: 8ä¸ªç°æœ‰æ–‡ä»¶
- **ä»£ç è¡Œæ•°**: 1200+ è¡Œ
- **æ–‡æ¡£è¡Œæ•°**: 3000+ è¡Œ

**æ‰€æœ‰åŠŸèƒ½å·²å®Œæ•´å®ç°å¹¶é€šè¿‡éªŒè¯ï¼** ğŸš€âœ¨

